<!DOCTYPE html>
<html>
  <head>
    <title>Welcome screen</title>
    <script src="jatos.js"></script>
    <script src="append_data_to_jatos.js"></script>
    <script src="https://static.psyact.org/jspsych-7.3.1/jspsych.js"></script>
    <script src="https://static.psyact.org/jspsych-7.3.1/plugins/plugin-html-keyboard-response.js"></script>
    <script src="https://static.psyact.org/jspsych-7.3.1/plugins/plugin-html-button-response.js"></script>    

    <link href="https://static.psyact.org/jspsych-7.3.1/css/jspsych.css" rel="stylesheet" type="text/css" />
    <style>
      /* Custom CSS to adjust font size */
      .jspsych-content {
          font-size: 27px; /* Adjust the font size as needed */
          line-height: 1.5; /* Adjust the line height as needed */
          font-family: 'Arial', sans-serif;
      }

      body {
       font-family: 'Arial', sans-serif;
      background-color:white;
      color: #333;
      }

      .compact-container {
        text-align: center;
      max-width: 75%;
      margin: auto;
      font-family: arial;
      position: relative;
        /* max-width: 1000px; Adjust maximum width as needed */
        /* margin: 0 auto; Center the container horizontally */
        /* text-align: center; Center-align text */
        /* padding: 20px; Add padding for spacing */
      }

      .jspsych-btn{
        font-family: 'Arial', sans-serif;
        font-size: 24px;
        padding: 15px 25px;
        border-radius: 2em;
        border: none;
        transition: background-color 0.4s ease-out;
        background: #4bd51c82;
        color: black;
        font-weight: 500;
        width: 10em;
        margin-top: 20px; 
    }


  </style>

  </head>
  <body></body>
  <script>
    //this page buffers between consent form and the questionnaires

    jatos.onLoad(() => {
    var jsPsych = initJsPsych({
      // on_trial_start: jatos.addAbortButton,
      on_trial_finish: function (data) {
        // save data after each trial
        let trial_data_save = jsPsych.data.get().last(1).json();
        append_data_to_jatos(trial_data_save); //adds data to server as the trial goes!!
      },
      //on_finish: () => jatos.endStudy(jsPsych.data.get().json())
      on_finish: () => jatos.startNextComponent()
    });
    jsPsych.data.addProperties({ 
      start_time: (new Date()).toISOString(),
      prolific_id: jatos.urlQueryParameters.PROLIFIC_PID,
      study_id: jatos.urlQueryParameters.STUDY_ID,
      session_id: jatos.urlQueryParameters.SESSION_ID
    }); //start time logged in every trial of same experiment
    
    // Save Prolific IDs to studySessionData for persistence across components
    jatos.studySessionData.prolific_id = jatos.urlQueryParameters.PROLIFIC_PID;
    jatos.studySessionData.study_id = jatos.urlQueryParameters.STUDY_ID;
    jatos.studySessionData.session_id = jatos.urlQueryParameters.SESSION_ID;
    

    var timeline = [];/* create timeline */
    
    
    // console.log("Prolific ID: " + jatos.urlQueryParameters.prolificId);

    var welcome_screen1 = {
        type: jsPsychHtmlButtonResponse,
        stimulus: jatos.componentJsonInput.welcome_screen1,
        choices: ['Continue'], //a button for continuing to view experiment
        post_trial_gap: 1000,
        on_finish: function(data){        
            //gather data about the participant computer here!
            let w = window.innerWidth;
            let h = window.innerHeight;
            let userAgent = navigator.userAgent;
            // check for the browser name
            let browserName;
            if (userAgent.indexOf("Firefox") > -1) {
                browserName = "Mozilla Firefox";
            } else if (userAgent.indexOf("Chrome") > -1) {
                browserName = "Google Chrome";
            } else if (userAgent.indexOf("Safari") > -1) {
                browserName = "Apple Safari";
            } else if (userAgent.indexOf("Opera") > -1) {
                browserName = "Opera";
            } else if (userAgent.indexOf("Edge") > -1) {
                browserName = "Microsoft Edge";
            } else if (userAgent.indexOf("Trident") > -1) {
                browserName = "Microsoft Internet Explorer";
            } else {
                browserName = "Unknown Browser";
            }

            jsPsych.data.addProperties({
                //IMPORTANT: I can use this function to stamp stuff onto every trial
                ptp_brower: browserName,
                ptp_window_width: w,
                ptp_window_height: h
            });
            jatos.startNextComponent();
        }
    }

    // Apply styling to the welcome screen stimulus
    welcome_screen1.stimulus = "<div class='compact-container'>" + welcome_screen1.stimulus + "</div>";

    timeline.push(welcome_screen1)

    /*var welcome_screen2 = {
        type: jsPsychHtmlButtonResponse,
        stimulus: jatos.componentJsonInput.welcome_screen2,
        choices: ['Start'], //a button for continuing to view experiment
        post_trial_gap: 1000
      }
    timeline.push(welcome_screen2)*/

    // jsPsych.run(timeline);

  // });

  
      
      // Run the experiment timeline
      jsPsych.run(timeline);
    });
  </script>
</html>